name: Windows.Triage.Collectors.NTFSMetadata

description: |
  Collect NTFS file system metadata sources.

  Credits: Thanks to Eric Zimmerman (@EricRZimmerman) for allowing us to leverage his work on NTFS metadata locations.
  References: https://github.com/EricZimmerman/KapeFiles

precondition: SELECT OS From info() where OS = 'windows'

reference:
  - https://github.com/EricZimmerman/KapeFiles

sources:
  - name: NTFS Metadata Files
    queries:
      - |
        SELECT * FROM Artifact.Triage.Collection.Upload(
        type="NTFS Metadata Files",
        accessor="ntfs",
        path=[
            "C:\\$MFT",
            "C:\\$LogFile",
            "C:\\$Extend\\$UsnJrnl:$J",
            "C:\\$Extend\\$UsnJrnl:$Max",
            "C:\\$Secure:$SDS",
            "C:\\$Boot",
            "C:\\$Extend\\$RmMetadata\\$TxfLog\\$Tops:$T"
        ])
